<% planned_expense = local_assigns[:planned_expense] || @planned_expense_for_move || @planned_expense %>
<%= form_with url: move_income_event_planned_expense_path(@income_event, planned_expense), method: :patch, local: true, class: "space-y-4" do |form| %>
  <div>
    <label class="block text-sm font-medium text-gray-700 mb-2">Move to Income Event</label>
    <select name="target_income_event_id" required class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
      <option value="">Select an income event...</option>
      <% @income_events.each do |income_event| %>
        <% next if income_event.id == @income_event.id %>
        <option value="<%= income_event.id %>">
          <%= income_event.description %> - <%= number_to_currency(income_event.expected_amount) %> (Expected: <%= income_event.expected_date.strftime("%b %d, %Y") %>)
        </option>
      <% end %>
    </select>
    <p class="mt-1 text-xs text-gray-500">Select the income event to move this planned expense to</p>
  </div>
  
  <div class="flex items-center justify-end gap-3 pt-4 border-t border-gray-200">
    <button type="button" onclick="this.closest('[id^=\"move-modal\"]').classList.add('hidden')" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
      Cancel
    </button>
    <%= form.submit "Move Expense", class: "px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors" %>
  </div>
<% end %>

