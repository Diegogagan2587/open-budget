<%= render "shared/flash" %>

<% content_for :title, t("task.recurring_tasks.index.title") %>

<div class="container mx-auto px-4">
  <h1 class="text-2xl font-bold mb-4"><%= t("task.recurring_tasks.index.title") %></h1>

  <div class="mb-6 flex flex-col gap-4 sm:flex-row sm:justify-between sm:items-center">
    <div class="flex flex-wrap gap-2 items-center">
      <%= link_to t("task.recurring_tasks.index.all_areas"), task_recurring_tasks_path, class: "px-3 py-1.5 rounded #{params[:task_area_id].blank? ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}" %>
      <% @task_areas.each do |area| %>
        <%= link_to area.name, task_recurring_tasks_path(task_area_id: area.id), class: "px-3 py-1.5 rounded #{params[:task_area_id].to_s == area.id.to_s ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}" %>
      <% end %>
    </div>
    <div class="flex flex-wrap gap-2 items-center">
      <%= link_to t("task.recurring_tasks.new_task"), new_task_recurring_task_path(task_area_id: params[:task_area_id]), class: "inline-flex items-center justify-center px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors" %>
      <%= link_to t("task.areas.index.title"), task_areas_path, class: "text-blue-600 hover:underline py-2" %>
    </div>
  </div>

  <% if @recurring_tasks.any? %>
    <div class="space-y-4">
      <% @recurring_tasks.each do |task| %>
        <%= render "task_card", task: task, task_area_id_filter: params[:task_area_id] %>
      <% end %>
    </div>
  <% else %>
    <div class="text-center py-12">
      <p class="text-gray-500"><%= t("task.recurring_tasks.index.empty") %></p>
    </div>
  <% end %>

  <%= turbo_frame_tag "task_detail_panel" %>
</div>
