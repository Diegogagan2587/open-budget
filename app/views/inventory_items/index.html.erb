<p style="color: green"><%= notice %></p>

<div class="container mx-auto px-4">
  <h1 class="text-2xl font-bold mb-4"><%= t("inventory_items.index.title") %></h1>

  <div class="mb-6 flex flex-col sm:flex-row gap-3 sm:gap-0 sm:justify-between sm:items-center">
    <%= render AddButtonComponent.new(
        label: t("inventory_items.index.add_item"),
        path: new_inventory_item_path
      ) %>

    <div class="flex flex-wrap gap-2">
      <%= link_to t("inventory_items.index.all"), inventory_items_path(stock_state: "all", category_id: @category_filter),
          class: "px-3 py-1.5 rounded #{@stock_filter == 'all' ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}" %>
      <%= link_to t("inventory_items.index.in_stock"), inventory_items_path(stock_state: "in_stock", category_id: @category_filter),
          class: "px-3 py-1.5 rounded #{@stock_filter == 'in_stock' ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}" %>
      <%= link_to t("inventory_items.index.low"), inventory_items_path(stock_state: "low", category_id: @category_filter),
          class: "px-3 py-1.5 rounded #{@stock_filter == 'low' ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}" %>
      <%= link_to t("inventory_items.index.empty_filter"), inventory_items_path(stock_state: "empty", category_id: @category_filter),
          class: "px-3 py-1.5 rounded #{@stock_filter == 'empty' ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}" %>
    </div>
  </div>

  <div class="mb-4 flex flex-wrap gap-2 items-center">
    <%= link_to t("inventory_items.index.all_categories"), inventory_items_path(stock_state: @stock_filter, category_id: nil),
        class: "px-3 py-1.5 rounded #{@category_filter.blank? ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}" %>
    <% @categories_for_filter.each do |category| %>
      <%= link_to category.name, inventory_items_path(stock_state: @stock_filter, category_id: category.id),
          class: "px-3 py-1.5 rounded #{@category_filter == category.id.to_s ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}" %>
    <% end %>
    <%= link_to t("inventory_items.index.uncategorized"), inventory_items_path(stock_state: @stock_filter, category_id: "uncategorized"),
        class: "px-3 py-1.5 rounded #{@category_filter == 'uncategorized' ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}" %>
  </div>

  <% if @grouped_inventory_items.any? %>
    <div class="space-y-8">
      <% @grouped_inventory_items.each do |category, items| %>
        <section>
          <h2 class="text-lg font-semibold text-gray-800 mb-3 pb-2 border-b border-gray-200">
            <%= category ? category.name : t("inventory_items.index.uncategorized") %>
          </h2>
          <div class="space-y-4">
            <% items.each do |inventory_item| %>
              <%= render "inventory_items/card", inventory_item: inventory_item, stock_filter: @stock_filter, category_filter: @category_filter %>
            <% end %>
          </div>
        </section>
      <% end %>
    </div>
  <% else %>
    <div class="text-center py-12">
      <p class="text-gray-500"><%= t("inventory_items.index.empty") %></p>
    </div>
  <% end %>
</div>
