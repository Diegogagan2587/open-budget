<%= render 'shared/flash' %>

<h1 class="text-2xl font-bold mb-4 px-2">Accounts</h1>

<div class="mb-4 flex justify-end px-8">
  <%= render AddButtonComponent.new( label: "New Account", path: new_account_path ) %>
</div>

<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
  <% @accounts.each do |account| %>
    <div class="border rounded p-4 hover:shadow-lg transition-shadow">
      <h2 class="text-xl font-semibold mb-2"><%= account.name %></h2>
      <p class="text-sm text-gray-600 mb-4">
        <% membership = account.account_memberships.find_by(user: Current.user) %>
        Role: <span class="font-semibold"><%= membership&.role&.capitalize %></span>
      </p>
      <div class="flex space-x-2">
        <%= render ViewButtonComponent.new(path: account, size: :small) %>
        <% if membership&.owner? %>
          <%= render EditButtonComponent.new(path: edit_account_path(account), size: :small) %>
        <% end %>
        <% if account == current_account %>
          <span class="px-3 py-1 bg-green-100 text-green-800 text-sm rounded">Current</span>
        <% else %>
          <%= form_with url: account_switch_path, method: :post, local: true, class: "inline" do |f| %>
            <%= f.hidden_field :account_id, value: account.id %>
            <%= f.submit "Switch", class: "px-3 py-1 bg-purple-500 text-white text-sm rounded hover:bg-purple-600 cursor-pointer" %>
          <% end %>
        <% end %>
      </div>
    </div>
  <% end %>
</div>

