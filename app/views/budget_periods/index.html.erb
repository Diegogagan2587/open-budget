<div class="max-w-5xl mx-auto px-4">
  <p style="color: green"><%= notice %></p>

  <div class="mb-6 flex flex-col gap-3 sm:flex-row sm:justify-between sm:items-center">
    <h1 class="text-xl sm:text-2xl font-bold"><%= t("budget_periods.index.title") %></h1>
    <%= render AddButtonComponent.new(
      label: t("budget_periods.new_budget_period"),
      path: new_budget_period_path,
      extra_class: "w-full sm:w-auto justify-center min-h-[44px]",
    ) %>
  </div>

  <% if @budget_periods.any? %>
    <%# Mobile: card list %>
    <div class="space-y-4 md:hidden">
      <% @budget_periods.each do |budget_period| %>
        <%= render partial: "budget_period_card", locals: { budget_period: budget_period } %>
      <% end %>
    </div>

    <%# Desktop: table %>
    <div class="hidden md:block overflow-x-auto">
      <table class="min-w-full bg-white border">
        <thead>
          <tr class="bg-gray-100">
            <th class="px-4 py-2 text-left"><%= t("budget_periods.table.name") %></th>
            <th class="px-4 py-2 text-left"><%= t("budget_periods.table.period_type") %></th>
            <th class="px-4 py-2 text-left"><%= t("budget_periods.table.start_date") %></th>
            <th class="px-4 py-2 text-left"><%= t("budget_periods.table.end_date") %></th>
            <th class="px-4 py-2 text-left"><%= t("budget_periods.table.total_income") %></th>
            <th class="px-4 py-2 text-left"><%= t("budget_periods.table.total_planned") %></th>
            <th class="px-4 py-2 text-left"><%= t("budget_periods.table.remaining") %></th>
            <th class="px-4 py-2 text-left"><%= t("shared.actions") %></th>
          </tr>
        </thead>
        <tbody>
          <% @budget_periods.each do |budget_period| %>
            <tr class="border-t">
              <td class="px-4 py-2"><%= budget_period.name %></td>
              <td class="px-4 py-2"><%= budget_period.period_type || "-" %></td>
              <td class="px-4 py-2"><%= budget_period.start_date %></td>
              <td class="px-4 py-2"><%= budget_period.end_date %></td>
              <td class="px-4 py-2"><%= number_to_currency(budget_period.total_income) %></td>
              <td class="px-4 py-2"><%= number_to_currency(budget_period.total_planned) %></td>
              <td class="px-4 py-2 <%= budget_period.remaining_budget < 0 ? 'text-red-600' : 'text-green-600' %>">
                <%= number_to_currency(budget_period.remaining_budget) %>
              </td>
              <td class="px-4 py-2">
                <%= link_to t("shared.view"), budget_period, class: "text-blue-500 hover:underline" %>
                <%= link_to t("shared.edit"), edit_budget_period_path(budget_period), class: "text-blue-500 hover:underline ml-2" %>
                <%= link_to t("budget_periods.show.income_events"), budget_period_income_events_path(budget_period), class: "text-green-500 hover:underline ml-2" %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <% else %>
    <div class="text-center py-12 bg-white rounded-xl border-2 border-dashed border-gray-300">
      <p class="text-gray-600 mb-4"><%= t("budget_periods.index.empty_message") %></p>
      <%= render AddButtonComponent.new(
        label: t("budget_periods.new_budget_period"),
        path: new_budget_period_path,
      ) %>
    </div>
  <% end %>
</div>
